{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2 style="margin:0 0 10px 0">Аккаунт: {{ a.name }}</h2>
  <div class="row">
    <div style="flex: 1 1 300px">
      <form method="post" action="/admin/accounts/{{ a.id }}/update">
        <label>Имя</label>
        <input name="name" value="{{ a.name }}" maxlength="128" required />
        <label style="margin-top:10px">Max slots</label>
        <input name="max_slots" type="number" min="1" max="20" value="{{ a.max_slots }}" required />
        <label style="margin-top:10px">Enabled</label>
        <select name="enabled">
          <option value="1" {% if a.enabled %}selected{% endif %}>Да</option>
          <option value="0" {% if not a.enabled %}selected{% endif %}>Нет</option>
        </select>
        <div style="margin-top:12px">
          <button type="submit">Сохранить</button>
          <a href="/admin/accounts" style="margin-left:10px" class="muted">назад</a>
        </div>
      </form>
    </div>

    <div style="flex: 1 1 320px">
      <h3 style="margin:0 0 10px 0">loginusers файл</h3>
      {% if a.file_sha256 %}
        <div>Статус: <span class="pill ok">загружен</span></div>
        <div class="hint">Имя: {{ a.file_name or "-" }}</div>
        <div class="hint">sha256: {{ a.file_sha256 }}</div>
        <div class="hint">Шифрование: {% if a.file_encrypted %}да{% else %}нет{% endif %}</div>
        <div class="hint">Обновлен: {{ a.file_updated_at or "-" }}</div>
        <div style="margin-top:10px">
          <a href="/admin/accounts/{{ a.id }}/download">Скачать (админ)</a>
        </div>
      {% else %}
        <div>Статус: <span class="pill bad">нет файла</span></div>
      {% endif %}

      <form method="post" action="/admin/accounts/{{ a.id }}/upload" enctype="multipart/form-data" style="margin-top:14px">
        <label>Загрузить/заменить файл</label>
        <input type="file" name="file" accept=".vdf,application/octet-stream" required />
        <label style="margin-top:10px">Шифровать (если FILE_ENC_KEY задан)</label>
        <select name="encrypt">
          <option value="1" selected>Да</option>
          <option value="0">Нет</option>
        </select>
        <div style="margin-top:12px"><button type="submit">Загрузить</button></div>
      </form>

      <form method="post" action="/admin/accounts/{{ a.id }}/delete_file" style="margin-top:14px">
        <button type="submit" style="background: rgba(255,124,124,0.18)">Удалить файл</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
