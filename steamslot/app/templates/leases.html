{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2 style="margin:0 0 12px 0">Слоты (leases)</h2>
  <div class="hint">Активные и последние 100 записей.</div>
  <table style="margin-top:10px">
    <thead>
      <tr>
        <th>ID</th><th>ПК</th><th>Аккаунт</th><th>Создан</th><th>Истекает</th><th>Освобождён</th><th>Статус</th><th class="right">Действия</th>
      </tr>
    </thead>
    <tbody>
    {% for l in leases %}
      <tr>
        <td class="muted">{{ l.id }}</td>
        <td><b>{{ l.pc_name }}</b></td>
        <td>{{ l.account_name }}</td>
        <td class="muted">{{ l.created_at }}</td>
        <td class="muted">{{ l.expires_at }}</td>
        <td class="muted">{{ l.released_at or "-" }}</td>
        <td class="muted">{{ l.status or "-" }}</td>
        <td class="right">
          {% if not l.released_at %}
          <form method="post" action="{{ root_path }}/admin/leases/{{ l.id }}/revoke" style="display:inline">
            <button type="submit" style="background: rgba(255,124,124,0.18)">Отозвать</button>
          </form>
          {% else %}
            <span class="muted">—</span>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
    {% if leases|length == 0 %}
      <tr><td colspan="8" class="muted">Пока пусто.</td></tr>
    {% endif %}
    </tbody>
  </table>
</div>
{% endblock %}
