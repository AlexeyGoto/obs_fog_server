{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2 style="margin:0 0 12px 0">ПК</h2>
  <table>
    <thead>
      <tr>
        <th>ID</th><th>Имя</th><th>Вкл</th><th>Аккаунт</th><th>API key</th><th class="right">Действия</th>
      </tr>
    </thead>
    <tbody>
    {% for p in pcs %}
      <tr>
        <td class="muted">{{ p.id }}</td>
        <td><b>{{ p.name }}</b></td>
        <td>{% if p.enabled %}<span class="pill ok">yes</span>{% else %}<span class="pill bad">no</span>{% endif %}</td>
        <td class="muted">{{ p.account_name or "-" }}</td>
        <td><code>{{ p.api_key[:10] }}…</code></td>
        <td class="right"><a href="/admin/pcs/{{ p.id }}">Открыть</a></td>
      </tr>
    {% endfor %}
    {% if pcs|length == 0 %}
      <tr><td colspan="6" class="muted">Добавьте первый ПК ниже.</td></tr>
    {% endif %}
    </tbody>
  </table>
</div>

<div class="card">
  <h3 style="margin:0 0 10px 0">Добавить ПК</h3>
  <form method="post" action="/admin/pcs">
    <div class="row">
      <div style="flex: 2 1 360px">
        <label>Имя ПК (уникально)</label>
        <input name="name" required maxlength="128" />
      </div>
      <div style="flex: 1 1 260px">
        <label>Привязать к аккаунту (необязательно)</label>
        <select name="account_id">
          <option value="">—</option>
          {% for a in accounts %}
            <option value="{{ a.id }}">{{ a.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div style="margin-top:10px">
      <label>API key (если пусто — сгенерируем)</label>
      <input name="api_key" />
    </div>

    <div style="margin-top:10px">
      <label>Enabled</label>
      <select name="enabled">
        <option value="1" selected>Да</option>
        <option value="0">Нет</option>
      </select>
    </div>

    <div style="margin-top:12px">
      <button type="submit">Создать</button>
    </div>
  </form>
</div>
{% endblock %}
