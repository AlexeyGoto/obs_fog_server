version: "3.8"

services:
  nginx-rtmp:
    image: tiangolo/nginx-rtmp
    restart: unless-stopped
    env_file: .env
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./streams:/streams
      - ./hls:/hls
    ports:
      - "1935:1935"
      - "8080:8080"

  notifier:
    image: python:3.11-slim
    restart: unless-stopped
    env_file: .env
    volumes:
      - ./monitor.py:/monitor.py:ro
      - ${STREAM_FOLDER}:/streams
    entrypoint: ["python", "/monitor.py"]
